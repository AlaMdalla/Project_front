<app-sidebar></app-sidebar>

<div class="container">
  <h2>Create evaluation</h2>

  <form [formGroup]="evaluationForm" (ngSubmit)="onSubmit()">

    <div class="form-group">
      <label for="description">Description of the evaluation:</label>
      <input id="description" type="text" formControlName="description" required>
    </div>

    <div class="form-group">
      <label for="evaluationDuration">Duration(minutes) :</label>
      <input id="evaluationDuration" type="number" formControlName="evaluationDuration" required>
    </div>
    <div class="form-group">
      <label for="niveau">Level:</label>
      <select id="niveau" formControlName="niveau" required>
        <option value="Beginner">Débutant</option>
        <option value="Intermediate">Intermédiaire</option>
        <option value="Advanced">Avancé</option>
      </select>
    </div>
    <div class="form-group">
      <label>Formation :</label>
      <input type="text" [value]="selectedTraining?.title" class="form-control" disabled>
    </div>



    <div class="form-group">
      <label for="score"> minimal Score :</label>
      <input id="score" type="number" formControlName="score" required>
    </div>

    <div class="form-group">
      <label for="type">Type :</label>
      <select id="type" formControlName="type">
        <option value="QCM">QCM</option>
        <option value="Ouverte">Ouverte</option>
      </select>
    </div>
    <!-- Questions -->
    <div formArrayName="questions">
      <div *ngFor="let question of questions.controls; let i = index" [formGroupName]="i">
        <label>Question Text:</label>
        <input formControlName="questionText" placeholder=" question text">

        <label>Bonne Réponse:</label>
        <input formControlName="bonneReponse" placeholder="Correct answer">

        <!-- Options -->
        <h4>Options</h4>
        <div formArrayName="options">
          <div *ngFor="let option of getOptionsControls(i).controls; let j = index">
            <input type="text" [formControlName]="j" placeholder="Option">
            <button type="button" (click)="removeOption(i, j)">❌</button>
          </div>
          <button type="button" (click)="addOption(i)">Add an Option</button>
        </div>

      </div>
    </div>

    <button type="button" class="btn" (click)="addQuestion()">➕ Add a  Question</button>
    <button type="submit" class="btn submit">✅ save the evaluation</button>
    <p *ngIf="isSubmitted" class="success-message">{{ successMessage }}</p>

  </form>
</div>
