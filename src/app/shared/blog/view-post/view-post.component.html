<div *ngIf="postData" class="post-container">
  <mat-card class="post-card">
    <!-- Header with Avatar and Post Info -->
    <mat-card-header>
      <div mat-card-avatar class="avatar-container">
        <img [src]="postData.avatar" alt="Avatar" class="avatar-img" (error)="postData.avatar = 'assets/img/default-avatar.jpg'">
      </div>
      <div class="post-header">
        <mat-card-title class="post-title">{{ postData.title }}</mat-card-title>
        <mat-card-subtitle class="post-subtitle">
          Posted By: {{ postData.postedBy }} | Category: {{ postData.category }} | Posted On: {{ postData.date | date: 'medium' }}
        </mat-card-subtitle>
      </div>
    </mat-card-header>

    <!-- Post Content and Image -->
    <div class="post-content">
      <mat-grid-list cols="2" rowHeight="200px">
        <mat-grid-tile>
          <div class="image-section">
            <img *ngIf="postData.img" [src]="'data:image/jpeg;base64,' + postData.img" alt="Post Image" class="post-image" />
            <div *ngIf="!postData.img" class="no-image">No image available</div>
          </div>
        </mat-grid-tile>
          <mat-grid-tile>
            <div class="content-section">
              <p class="post-text">{{ postData.content }}</p>
            </div>
          </mat-grid-tile>
        
      </mat-grid-list>
    </div>
    

    <!-- Reactions -->
    <mat-card-actions class="reaction-actions">
      <div class="reaction-group">
        <button mat-stroked-button color="primary" (click)="reactPost('like')" class="reaction-button">
          <mat-icon>favorite</mat-icon> {{ postData.likeCount || 0 }}
        </button>
        <button mat-stroked-button color="primary" (click)="reactPost('laugh')" style="margin-left: 10px;" class="reaction-button">
          <mat-icon>mood</mat-icon> {{ postData.laught || 0 }}
        </button>
        <button mat-stroked-button color="primary" (click)="reactPost('angry')" style="margin-left: 10px;" class="reaction-button">
          <mat-icon>mood_bad</mat-icon> {{ postData.angry || 0 }}
        </button>
      </div>
      <button mat-flat-button color="warn" (click)="goToReclamationForm()" class="report-button">
        <mat-icon>report</mat-icon> Report
      </button>
    </mat-card-actions>
  </mat-card>

  <!-- Comments Section -->
  <div class="comments-section">
    <h3 class="comments-title">Comments</h3>
    <mat-card *ngFor="let comment of comments" class="comment-card">
      <mat-card-header>
        <div mat-card-avatar class="avatar-container">
          <img [src]="comment.avatar" alt="Avatar" class="avatar-img" (error)="comment.avatar = 'assets/img/default-avatar.jpg'">
        </div>
        <div class="comment-header">
          <mat-card-title class="comment-title">{{ comment.postedBy }}</mat-card-title>
          <mat-card-subtitle class="comment-subtitle">{{ comment.createdAt | date: 'medium' }}</mat-card-subtitle>
        </div>
      </mat-card-header>
      <mat-card-content class="comment-content">
        <p>{{ comment.content }}</p>
      </mat-card-content>
      <mat-card-actions>
        <button mat-button (click)="comment.showReply = !comment.showReply" class="reply-button">
          <mat-icon>reply</mat-icon> Reply
        </button>
      </mat-card-actions>
      <div *ngIf="comment.showReply" class="reply-form">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Write a reply...</mat-label>
          <input matInput [(ngModel)]="comment.replyContent" placeholder="Type your reply...">
        </mat-form-field>
        <button mat-raised-button color="primary" (click)="replyToComment(comment.id); comment.showReply = false" class="submit-reply-button">
          Submit
        </button>
      </div>
      <div *ngIf="comment.replies?.length" class="replies-section">
        <mat-card *ngFor="let reply of comment.replies" class="reply-card">
          <mat-card-header>
            <div mat-card-avatar class="avatar-container">
              <img [src]="reply.avatar || 'assets/img/default-avatar.jpg'" alt="Avatar" class="avatar-img">
            </div>
            <div class="reply-header">
              <mat-card-title class="reply-title">{{ reply.postedBy }}</mat-card-title>
              <mat-card-subtitle class="reply-subtitle">{{ reply.createdAt | date: 'medium' }}</mat-card-subtitle>
            </div>
          </mat-card-header>
          <mat-card-content class="reply-content">
            <p>{{ reply.content }}</p>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-card>
  </div>

  <!-- Comment Form -->
  <mat-card class="comment-form-card">
    <mat-card-content>
      <h3 class="comment-form-title">ðŸ’¬ Publish Your Comment</h3>
      <form [formGroup]="CommentForm">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Your Comment</mat-label>
          <textarea matInput formControlName="content" placeholder="Write your comment here..." required></textarea>
        </mat-form-field>
        <mat-form-field appearance="outline" class="full-width" style="margin-top: 15px;">
          <mat-label>Your Name</mat-label>
          <input matInput formControlName="postedBy" placeholder="Write your name here" required>
        </mat-form-field>
        <div class="button-container">
          <button mat-raised-button color="primary" (click)="publishComment()" [disabled]="!CommentForm.valid">
            <mat-icon>send</mat-icon> Publish
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>